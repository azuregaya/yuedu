<script type="text/javascript" src="js/yd.js"></script>
<script type="text/javascript">
jQuery.noConflict();
msgInput("topsearch","s-fc4","搜索内容源");
msgInput("eipt","s-fc4","请输入E-mail地址");
testEpt("topsearch");
hoverShow({
	ctrl:$("tops").getElementsByTagName("li"),
	content:$$("tops","m-tips")
});
window.onload=function(){
	slidePlayer({
		wrap:$("sliderWrap"),
		sliders:$("sliderWrap").getElementsByTagName("li"),
		show:true
	});
	slidePlayer({
		wrap:$("sliderWrap4"),
		sliders:$("sliderWrap4").getElementsByTagName("li"),
		up:true,
		one:3
	});
	slidePlayer({
		wrap:$("sliderWrap3"),
		controls:$("controls3").getElementsByTagName("li"),
		sliders:$("sliderWrap3").getElementsByTagName("li"),
		show:true
	});
	slidePlayer({
		wrap:$("dslide1"),
		sliders:$$("dslide1","m-dlist-2s"),
		prv:$$("dslide1-ctrl","prv")[0],
		nxt:$$("dslide1-ctrl","nxt")[0],
		auto:false
	});
	slidePlayer({
		wrap:$("dslide2"),
		sliders:$$("dslide2","m-dlist-2s"),
		prv:$$("dslide2-ctrl","prv")[0],
		nxt:$$("dslide2-ctrl","nxt")[0],
		auto:false
	});
	
	var isEmail = function(str){
		var p = /^([\w\.-]+)@([a-zA-Z0-9-]+)(\.[a-zA-Z\.]+)$/;
		if(str.search(p) == -1){
			return false;
		}else{
			return true;
		}
	}
	
	var tipArr = ['您输入邮件地址有误,请重新输入。','订阅失败，系统发生错误。','邮件订阅成功!'];
	
	var emailIpt = jQuery('#eipt'), emailSub = jQuery('#esub'),emailTip = jQuery('.m-subs p.tip');
	emailSub.click(function(){
		var eVal = jQuery.trim(emailIpt.val());
		if(eVal.length === 0){
			emailTip.html(tipArr[0]);
			emailTip.removeClass('tip1 tip2 tip3').addClass('tip1');
		}
		if(isEmail(eVal)){
			//发送ajax请求，返回状态 ok为成功
			jQuery.ajax({
				url: 'http://www.google.com?'+'email='+ eVal,
				success : function(data){
					if(data === 'ok'){
						emailTip.html(tipArr[2]);
						emailTip.removeClass('tip1 tip2 tip3').addClass('tip3');
					}else{//返回值失败报错
						emailTip.html(tipArr[1]);
						emailTip.removeClass('tip1 tip2 tip3').addClass('tip2');
					}
				},
				error : function(){//ajax发送失败报错
					emailTip.html(tipArr[1]);
					emailTip.removeClass('tip1 tip2 tip3').addClass('tip2');
				}
			});
		}else{
			emailTip.html(tipArr[0]);
			emailTip.removeClass('tip1 tip2 tip3').addClass('tip1');
		}
		
	});
}



</script>

<div id="eroTip" style="display:none;" class="m-layer m-layer-3">
    <div class="lytt yy"><h4></h4><a href="#" class="lyclose j-close">关闭</a></div>
    <div class="lyct">
        <div class="m-actip">
            <h3>订阅出错！！！</h3>
			<a href="#" class="btn j-close">我知道了</a>
        </div>
    </div>
    <div class="lybt">
        <button class="j-close">我知道了</button>
    </div>
</div>
<div id="openYD" class="m-open f-dn">
	<div class="inner">
	<h4>Hi，XXX大河马，<em>轻松四步，随时随地阅读</em></h4>
	<a id="get-yd" class="yeap"></a>
	<a class="nope closeit">不，谢谢</a>
	<a class="clbtn closeit"></a>
	</div>
</div>
<div class="m-mask f-dn"></div>


<script type="text/javascript" src="js/yd.js"></script>
<script type="text/javascript">
msgInput("topsearch","s-fc4","搜索内容源");
testEpt("topsearch");

/* 阅读提示框代码 */
jQuery.noConflict();
jQuery(document).ready(function(){
	var pop = jQuery('#openYD'),mask = jQuery('.m-mask'), getBtn = jQuery('#get-yd');
	var setPosition = function(){
		var dh = jQuery(window).height();
		var dt = jQuery(document).scrollTop();
		var lh = pop.height(),lw = pop.width();
		if(dh > lh){
			pop.lcss('top',(dt+((dh-lh)/2)+"px"));
		}else{
			pop.css('top',(dt+((lh-dh)/2)+"px"));
		}
		pop.css('left','50%');
		pop.css('margin-left',-(lw/2)+"px");l
		//jQuery('#profile').css('top');
	}

	jQuery('.w-ding').bind('click',function(){
		pop.toggleClass('f-dn');
		setPosition();
		mask.height(jQuery(document).height());
		mask.toggleClass('f-dn');
	});

	jQuery('.closeit').bind('click',function(){
		pop.toggleClass('f-dn');
		mask.toggleClass('f-dn');
	});
	
	getBtn.bind('click',function(){
		if(callback()){
			window.location.href = 'http://www.taobao.com';
		}else{
			layerOpen('eroTip');
			jQuery('#eroTip').css('z-index',10001);
		}
	});
	
	var callback = function(){
		return false;
	}
	
});
window.onload = function(){
	var testIE6 = function(){
		if(jQuery.browser.msie){
			if(jQuery.browser.version === '6.0') {
				jQuery.getScript('http://a.tbcdn.cn/apps/hitao/sys/pngfix.js',function(){
					DD_belatedPNG.fix('.clbtn');
				});
			}
		}
	}
	testIE6();
}
</script>